<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BrowserViz:  A base class providing simple, extensible message passing between your R session and web browser, for interactive data visualization. • BrowserViz</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BrowserViz:  A base class providing simple, extensible message passing between your R session and web browser, for interactive data visualization.">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BrowserViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/BrowserViz.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>BrowserViz: A base class providing simple, extensible message passing between your R session and web browser, for interactive data visualization.</h1>
                        <h4 class="author">Paul Shannon</h4>
            
            <h4 class="date">2019-09-26</h4>
      
      
      <div class="hidden name"><code>BrowserViz.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>BrowserViz provides the basis for, and a very simple working example of, interactive R/browser visualization. Thus two interactive powerful and complementary environments are linked, creating a powerful hybrid setting for exploratory data analysis.</p>
<p>This work is motivated by our belief that contemporary web browsers, supporting HTML5 and Canvas, and running increasingly powerful Javascript libraries (for example, <a href="https://d3js.org/">d3</a>) and <a href="http://js.cytoscape.org/">cytoscape.js</a> have become the best setting in which to develop interactive graphics for exploratory data analysis. We predict that web browsers, already powerful and easily programmed, will steadily improve in rendiring power and interactivity, and thus remain the optimal setting for interactive R visualization for years to come.</p>
<p><a href="https://shiny.rstudio.com">Shiny</a> and <a href="https://www.htmlwidgets.org/">htmlwidgets</a> are two very popular packages which provide solutions to this same general problem: how does one use the power of web browser graphics from R?<br>
Both of these package create bindings in R to HTML widgets and Javascript objects. This creates representations for these objects in R: a button, a d3 scatterplot, an interactive geographic map. The two packages provide elegant support for these bindings and a clear path to creating more of them.</p>
<p>The principal different between BrowserViz and these worthy packages is the use of only <strong>loose coupling</strong> of R and the browser. In slogan form, our approach can be summarized, ``let R be R, and Javascript be Javascript’’. BrowserViz links wwo rich programming environments, but the environments are kept maximally ignorant of each other. Only simple JSON messages pass back and forth, and these are at a high semantic level: no HTML, CSS or Javascript. Rather than creating representations of web objects in R, which would be tight-coupling of the two environments, BrowserViz provides a style of programming in which</p>
<ul>
<li>Web objects are (just as in standard widespread web programming) created in HTML, CSS and Javascript</li>
<li>JSON and websockets provide simple explicit message passing between R and the browser</li>
<li>High-level web objects (i.e., an xy plotter, or a network viewer) are created by and manipulated by Javscript functions at the request of high-level R function calls</li>
<li>Web elements can initiate (call back to) R functions</li>
<li>A traditional event-driven architecture is used throughout, in which events are either R function calls or user (keyboard or mouse) actions in the browser.</li>
</ul>
<p>BrowserViz provides a very low threshold for those wishing to create R/web browser visualizations. This base package hides the complexity of websocket initiation and message passing. The websocket communication channel is created with a single R function call. Passing messages and handling responses is similarly simple. The intricacy (or simplicity) of the web browser interface is determined by the programmer. A vast collection of easily available books, examples, tutorials, and support websites make web browser programming especially easy to learn. The BrowserViz approach will be of interest to any programmer interested in the visualization of data, and proficient in – or willing to learn – both R and Javascript.</p>
<p>Standalone web sites can be created, but the primary intended audience for this package is the R programmmer exploring and analyzing data in R and using the browser visualization for the indispensable benefits it provides. We hope that many visualization tools will be created. We provide a simple x-y plotter (see BrowserVizDemoto illustrate how to write a BrowserViz subclass application. The Biocondcutor RCyjs package is a full-featured visualization tool for network visualization built upon <a href="http://js.cytoscape.org">cytoscape.js</a> and the web browser.</p>
<p>The BrowserViz class, though a base class intended for subclassing, includes a simple demo which performs a few elementary browser manipulations, and queries the browser for some simple state (window size, window title, browser version). The principal goal of the package is to provide the the websocket ``plumbing’’ along with a standard (simple, open-ended) message protocol for communicating between the two environments.</p>
</div>
<div id="standard-message-format" class="section level1">
<h1 class="hasAnchor">
<a href="#standard-message-format" class="anchor"></a>Standard Message Format</h1>
<p>Just as the ubiquitous and language-neutral <a href="https://en.wikipedia.org/wiki/WebSocket">websocket</a> protocol provides the BrowserViz communication mechanism, so does <a href="https://www.w3schools.com/js/js_json_intro.asp">JSON</a> provide the message notation. Native data types in R (a named list, for instance) and Javascript (an object, with key:value pairs) are easily converted to and from JSON by libraries standard in each language. R data.frames are a little trickier.</p>
<p>We have adopted a simple, adaptable data structure flexible enough for all of the uses so far encountered. In JSON (and Javascript):</p>
<pre><code>    {{cmd: "setBrowserWindowTitle",
      status: "request",
      callback:"handleResponse", 
      payload: "BrowserViz Demo"}}</code></pre>
<p>Websocket servers both send and receive messages. Thus a typical BrowserViz event begins with sending a message from one environment to the other, and often concludes with some sort of a return or <strong>callback</strong> message.</p>
<ul>
<li>
<strong>cmd</strong>: the name of the operation the sender wishes to be performed by the receiver.</li>
<li>
<strong>status</strong>: might be <code>success'',</code>failure’‘, <code>error'',</code>deferred response’’.</li>
<li>
<strong>callback</strong>: provided by the sender, this specifies the operation which the receiver is to call <em>in the client</em> after it (the receiver) completes the operation it was asked to perform.</li>
<li>
<strong>payload</strong> An open-ended data structure, sometimes empty, as simple as a character string, as complex as any conceivable deeply nested list.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(jsonlite)
  msg &lt;-<span class="st"> </span><span class="kw"><a href="../reference/toJSON.html">toJSON</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">cmd=</span><span class="st">"setBrowserWindowTitle"</span>,
                     <span class="dt">status=</span><span class="st">"request"</span>, 
                     <span class="dt">callback=</span><span class="st">"handleResponse"</span>,
                     <span class="dt">payload=</span><span class="st">"BrowserViz demo"</span>))</code></pre></div>
<p>The callback for this request could be empty, which by convention we encode as the empty string. The calling code, in R, and the receiving code, in Javascript, only need to be consistent. If the caller provides a non-empty <em>callback</em>, the Javascript receiver should craft and send a return message with the canonical four fields specifying <em>cmd=callback</em> and any <em>payload</em> the caller expects, perhaps</p>
<pre><code>    {cmd: "handleResponse",
    status: "success",
    callback:"",
    payload: "BrowserViz Demo"}</code></pre>
<p>An empty <strong>payload</strong> could also be used, in which case the <strong>success</strong> status of the return command is the only information returned from Javascript to R. All decisions of this sort are left to the programmer. Often the same person writes the R and the Javascript code that talk back and forth over the websocket. If different programmers are involved, then careful communication and documentation is required, of the expectations, contraints and *payload( structure.</p>
</div>
<div id="the-simple-browserviz-application" class="section level1">
<h1 class="hasAnchor">
<a href="#the-simple-browserviz-application" class="anchor"></a>The Simple BrowserViz ``Application’’</h1>
<p>We predict that the principal use of BrowserViz will be as a base class for other rich visualzation packages, and that authors of those derived classes will be be able to proceed without any direct involvement in the nuts and bolts of websocket creation and handling. Nonetheless, BrowserViz is a complete R/browser application, albeit one with only a few features. These features (R methods on the BrowserViz object), few though they be, are automatically available to all BrowserViz subclasses.</p>
<ul>
<li>port</li>
<li>ready</li>
<li>browserResponseReady</li>
<li>getBrowserResponse</li>
<li>closeWebSocket</li>
<li>send</li>
<li>getBrowserWindowSize</li>
<li>getBrowserWindowTitle</li>
<li>setBrowserWindowTitle</li>
<li>roundTripTest</li>
<li>displayHTMLInDiv</li>
</ul>
<p>The last two of these methods are used in daily tests of this package. Conceptually simple, they also illustrate basic use:</p>
<p>Note that the <strong>browserVizBrowserFile</strong> mentioned in the second and sixth lines below, and which is included in this package, is a combination of HTML, javascript and css. When you construct a BrowerViz application, you supply this filename; this file is sent to the browser. When received and interpreted in the browser, the HTML is rendered into the page, and the Javascript code executes, requesting a websocket connection right back to the R session’s http/websocket server. After the connection is established, messages can flow back and forth between the two environments, R and the web browser.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(BrowserViz)
browserVizBrowserFile &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="dt">package=</span><span class="st">"BrowserViz"</span>, <span class="st">"browserCode"</span>,
                                     <span class="st">"dist"</span>, <span class="st">"bvDemoApp.html"</span>)
PORT_RANGE &lt;-<span class="st"> </span><span class="dv">12111</span><span class="op">:</span><span class="dv">12120</span>
<span class="cf">if</span>(BrowserViz<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BrowserViz/man/webBrowserAvailableForTesting.html">webBrowserAvailableForTesting</a></span>()){
   bvApp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/BrowserViz.html">BrowserViz</a></span>(<span class="dt">browserFile=</span>browserVizBrowserFile, <span class="dt">quiet=</span><span class="ot">TRUE</span>)
   data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">lowercase=</span>letters, <span class="dt">uppercase=</span>LETTERS)
   json.returned &lt;-<span class="st"> </span><span class="kw"><a href="../reference/roundTripTest.html">roundTripTest</a></span>(bvApp, data)
   data.returned &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fromJSON.html">fromJSON</a></span>(json.returned)
   <span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"    %5d bytes exchanged"</span>, <span class="kw"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(json.returned)))
   <span class="kw"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span>(data <span class="op">==</span><span class="st"> </span>data.returned)
   html &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"&lt;h3&gt;round trip of json-encoded data, %d chars&lt;/h3&gt;"</span>,
                   <span class="kw"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(json.returned))
   <span class="kw"><a href="../reference/displayHTMLInDiv.html">displayHTMLInDiv</a></span>(bvApp, html, <span class="st">"bvDemoDiv"</span>)
   }</code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#standard-message-format">Standard Message Format</a></li>
      <li><a href="#the-simple-browserviz-application">The Simple BrowserViz ``Application’’</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul Shannon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
